# powershell_generateTable
creating a table in a docx document based on templates

## RUS
Скрипт generateTable.ps1 предназначен для генерации таблиц в документах на основании исходных данных.
Скрипт запускается ярлыком generateTable.lnk

**Возможности скрипта:**
- возможность настройки парсинга на основе регулярных выражений любых исходных данных;
- фильтрация полученых объектов по значению указанного поля (включая инверсию).

Файл настроек *.conf должен содержать обязательные параметры:
| **Параметр** | **Описание**  |
|----------------------------|------------------------------------------------------------|
| pattern_search |  Регулярное выражение с именованными группами для трансляции их карту полей записи. |
| table_number |  Номер таблицы для вставки данных. |
| employees_initials |  Использование иницалов в место полного ФИО (пример - Иванов И.В.) |
| employees_position |  Вставлять должность в трейтий столбец. |
| filter_list | Список, сразделителем "," для фильтрации полученых записей по значению поля указанного в filter_field. |
| filter_enable | Включение фильтрации (допустимые значения: true - включен и false - выключен). |
| filter_invers | Инвертирование фильтра (допустимые значения: true - включен и false - выключен). |
| ffilter_field | Наименование поля для фильтрации (должно соответсвовать названию одной из групп отбора регулярным выражением pattern_search) |
| sorting_field | Наименование поля для сортировки (должно соответсвовать названию одной из групп отбора регулярным выражением pattern_search). |

По умолчанию регулярное выражение для отбора входных данных сотавлено для выгрузки из 1С-ЗуП в формате txt с разделителем - табуляция (файл примера - source_data.txt):

| **Реквизит 1С** | **Поле**  |
|----------------------------|------------------------------------------------------------|
| Сотрудник | fio |
| Комментарий | komment (опционально может содержался в поле исходных данных "Сотрудник")|
| Дата рождения | birthdate  |
| Адрес места проживания | registration (может быть пустым)|
| Серия(паспорт) | id_serial (может быть пустым)|
| Номер(паспорт) | id_number (может быть пустым)|
| Дата(паспорт) выдачи | date_of_issue (может быть пустым)|
| Кем выдано(паспорт) | owner_id (может быть пустым)|
| Код подразделения(паспорт) | owner_id_number (может быть пустым)|
| Должность по штатному расписанию | position |
| Подразделение | division (содержится в поле исходных данных "Должность по штатному расписанию")|
| Пол | gender (может быть пустым)|

В регулярном выражении предложенном по умолчанию формируются именнованные группы с соответсвующими названиями полей. Данные полученые из каждой строки будут добавлены в хештаблицу вида hashtable @{UID, @{field, value}}.
По умолчанию вставка должности включена.
По умолчанию фильтр выключен.
По умолчанию инверсия фильтр выключен.
Полученые файлы сохраняются в каталог запуска программы.